{"ast":null,"code":"import { LOGIN_REQUEST, LOGIN_SUCCESS, LOGIN_FAILURE, LOGIN_RESET, EDIT_PROFILE_REQUEST, EDIT_PROFILE_SUCCESS, EDIT_PROFILE_FAILURE, EDIT_PROFILE_RESET, LOGOUT } from './types';\nimport { loginApi, logoutApi, editProfileApi } from '../api';\nimport store from '../store';\nimport { hideModal } from './modal';\nimport { apiErrorHandler } from '../utils/errorhandler';\nexport const login = (username, password) => dispatch => {\n  dispatch(loginRequest());\n  loginApi(username, password).then(response => {\n    dispatch(loginSuccess(response.data));\n    dispatch(hideModal());\n  }).catch(error => {\n    const errorMessage = apiErrorHandler(error);\n    dispatch(loginFailure(errorMessage));\n  });\n};\nexport const loginRequest = () => {\n  return {\n    type: LOGIN_REQUEST\n  };\n};\nexport const loginSuccess = data => {\n  return {\n    type: LOGIN_SUCCESS,\n    token: data.token,\n    username: data.username,\n    name: data.name,\n    avatar: data.avatar,\n    isStaff: data.is_staff\n  };\n};\nexport const loginFailure = error => {\n  return {\n    type: LOGIN_FAILURE,\n    error\n  };\n};\nexport const logout = () => dispatch => {\n  logoutApi();\n  dispatch({\n    type: LOGOUT\n  });\n};\nexport const loginReset = () => {\n  return {\n    type: LOGIN_RESET\n  };\n};\nexport const editProfile = newProfile => dispatch => {\n  dispatch(editProfileRequest());\n  const username = store.getState().auth.username;\n\n  if (!username) {\n    dispatch(editProfileFailure('Not authenticated'));\n  } else {\n    editProfileApi(username, newProfile).then(response => {\n      dispatch(editProfileSuccess(newProfile));\n    }).catch(error => {\n      const errorMessage = apiErrorHandler(error);\n      dispatch(editProfileFailure(errorMessage));\n    });\n  }\n};\nexport const editProfileRequest = () => {\n  return {\n    type: EDIT_PROFILE_REQUEST\n  };\n};\nexport const editProfileSuccess = newProfile => {\n  return {\n    type: EDIT_PROFILE_SUCCESS,\n    avatar: newProfile.avatar,\n    name: newProfile.name\n  };\n};\nexport const editProfileFailure = error => {\n  return {\n    type: EDIT_PROFILE_FAILURE,\n    error\n  };\n};\nexport const editProfileReset = () => {\n  return {\n    type: EDIT_PROFILE_RESET\n  };\n};","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/actions/auth.js"],"names":["LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILURE","LOGIN_RESET","EDIT_PROFILE_REQUEST","EDIT_PROFILE_SUCCESS","EDIT_PROFILE_FAILURE","EDIT_PROFILE_RESET","LOGOUT","loginApi","logoutApi","editProfileApi","store","hideModal","apiErrorHandler","login","username","password","dispatch","loginRequest","then","response","loginSuccess","data","catch","error","errorMessage","loginFailure","type","token","name","avatar","isStaff","is_staff","logout","loginReset","editProfile","newProfile","editProfileRequest","getState","auth","editProfileFailure","editProfileSuccess","editProfileReset"],"mappings":"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","sourcesContent":["import {\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAILURE,\r\n  LOGIN_RESET,\r\n  EDIT_PROFILE_REQUEST,\r\n  EDIT_PROFILE_SUCCESS,\r\n  EDIT_PROFILE_FAILURE,\r\n  EDIT_PROFILE_RESET,\r\n  LOGOUT,\r\n} from './types';\r\nimport {loginApi, logoutApi, editProfileApi} from '../api';\r\nimport store from '../store';\r\nimport {hideModal} from './modal';\r\nimport {apiErrorHandler} from '../utils/errorhandler';\r\n\r\nexport const login = (username, password) => dispatch => {\r\n  dispatch(loginRequest());\r\n\r\n  loginApi(username, password)\r\n    .then(response => {\r\n      dispatch(loginSuccess(response.data));\r\n      dispatch(hideModal());\r\n    })\r\n    .catch(error => {\r\n      const errorMessage = apiErrorHandler(error);\r\n      dispatch(loginFailure(errorMessage));\r\n    });\r\n};\r\n\r\nexport const loginRequest = () => {\r\n  return {\r\n    type: LOGIN_REQUEST,\r\n  };\r\n};\r\n\r\nexport const loginSuccess = data => {\r\n  return {\r\n    type: LOGIN_SUCCESS,\r\n    token: data.token,\r\n    username: data.username,\r\n    name: data.name,\r\n    avatar: data.avatar,\r\n    isStaff: data.is_staff,\r\n  };\r\n};\r\n\r\nexport const loginFailure = error => {\r\n  return {\r\n    type: LOGIN_FAILURE,\r\n    error,\r\n  };\r\n};\r\n\r\nexport const logout = () => dispatch => {\r\n  logoutApi();\r\n  dispatch({\r\n    type: LOGOUT,\r\n  });\r\n};\r\n\r\nexport const loginReset = () => {\r\n  return {\r\n    type: LOGIN_RESET,\r\n  };\r\n};\r\n\r\nexport const editProfile = newProfile => dispatch => {\r\n  dispatch(editProfileRequest());\r\n\r\n  const username = store.getState().auth.username;\r\n  if (!username) {\r\n    dispatch(editProfileFailure('Not authenticated'));\r\n  } else {\r\n    editProfileApi(username, newProfile)\r\n      .then(response => {\r\n        dispatch(editProfileSuccess(newProfile));\r\n      })\r\n      .catch(error => {\r\n        const errorMessage = apiErrorHandler(error);\r\n        dispatch(editProfileFailure(errorMessage));\r\n      });\r\n  }\r\n};\r\n\r\nexport const editProfileRequest = () => {\r\n  return {\r\n    type: EDIT_PROFILE_REQUEST,\r\n  };\r\n};\r\n\r\nexport const editProfileSuccess = newProfile => {\r\n  return {\r\n    type: EDIT_PROFILE_SUCCESS,\r\n    avatar: newProfile.avatar,\r\n    name: newProfile.name,\r\n  };\r\n};\r\n\r\nexport const editProfileFailure = error => {\r\n  return {\r\n    type: EDIT_PROFILE_FAILURE,\r\n    error,\r\n  };\r\n};\r\n\r\nexport const editProfileReset = () => {\r\n  return {\r\n    type: EDIT_PROFILE_RESET,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}