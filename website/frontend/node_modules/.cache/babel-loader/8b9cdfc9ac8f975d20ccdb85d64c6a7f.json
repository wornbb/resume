{"ast":null,"code":"import React,{Component}from'react';import{Link}from'react-router-dom';import{getSelectedBlock}from'draftjs-utils';import htmlToDraft from'html-to-draftjs';import{List}from'immutable';import{EditorState,ContentState,convertFromRaw,convertToRaw,Modifier}from'draft-js';import{Form,Icon,Divider,Button}from'semantic-ui-react';import'./styles.css';import RichEditor from'../richeditor';import StatusMessage from'../statusmessage';export default class NewThread extends Component{constructor(props){super(props);this.convertToEditorState=content=>{let editorState=EditorState.createEmpty();if(content){try{const contentState=convertFromRaw(JSON.parse(content));editorState=EditorState.createWithContent(contentState);}catch(error){const contentState=ContentState.createFromText(content);editorState=EditorState.createWithContent(contentState);}}return editorState;};this.toggleShowEditor=()=>{this.props.toggleShowEditor();};this.onSave=()=>{// save to redux store (uncontrolled input way)\nconst _this$state=this.state,name=_this$state.name,editorState=_this$state.editorState;const content=JSON.stringify(convertToRaw(editorState.getCurrentContent()));this.props.updateNewThread({name:name,content:content});this.toggleShowEditor();};this.onCancel=()=>{// reset & clear everything\nconst editorState=EditorState.createEmpty();this.setState({name:'',editorState});const content=JSON.stringify(convertToRaw(editorState.getCurrentContent()));this.props.updateNewThread({name:'',content:content});this.toggleShowEditor();};this.onNameChange=(e,{value})=>{this.setState({name:value});};this.onEditorStateChange=editorState=>{this.setState({editorState});};this.isFormValid=()=>{const name=this.state.name;return name;};this.onSubmit=()=>{if(this.isFormValid()){const _this$state2=this.state,name=_this$state2.name,editorState=_this$state2.editorState;const _this$props=this.props,forum=_this$props.forum,createThread=_this$props.createThread;const content=JSON.stringify(convertToRaw(editorState.getCurrentContent()));let newThread={name:name,forum:forum,content:content};createThread(newThread);}};this.isValidLength=contentState=>{const maxLength=this.props.maxLength||100;return contentState.getPlainText('').length<=maxLength;};this.handleBeforeInput=input=>{const editorState=this.state.editorState;if(!this.isValidLength(editorState.getCurrentContent())){return'handled';}};this.handlePastedText=(text,html,editorState,onChange)=>{if(html){const contentBlock=htmlToDraft(html);let contentState=editorState.getCurrentContent();contentBlock.entityMap.forEach((value,key)=>{contentState=contentState.mergeEntityData(key,value);});contentState=Modifier.replaceWithFragment(contentState,editorState.getSelection(),new List(contentBlock.contentBlocks));if(!this.isValidLength(contentState)){return'handled';}onChange(EditorState.push(editorState,contentState,'insert-characters'));return true;}const selectedBlock=getSelectedBlock(editorState);const newState=Modifier.replaceText(editorState.getCurrentContent(),editorState.getSelection(),text,editorState.getCurrentInlineStyle());if(!this.isValidLength(newState)){return'handled';}onChange(EditorState.push(editorState,newState,'insert-characters'));if(selectedBlock&&selectedBlock.type==='code'){return true;}return false;};const _this$props2=this.props,_name=_this$props2.name,_content=_this$props2.content;let _editorState=this.convertToEditorState(_content);this.state={name:_name,editorState:_editorState};}componentWillReceiveProps(newProps){const newName=newProps.name,newContent=newProps.content;const editorState=this.convertToEditorState(newContent);this.setState({name:newName,editorState});}render(){const _this$props3=this.props,isAuthenticated=_this$props3.isAuthenticated,isLoading=_this$props3.isLoading,success=_this$props3.success,id=_this$props3.id,error=_this$props3.error,showEditor=_this$props3.showEditor;const _this$state3=this.state,name=_this$state3.name,editorState=_this$state3.editorState;if(!isAuthenticated){return React.createElement(\"div\",{className:\"newThread-none\"});}const statusMessage=React.createElement(StatusMessage,{error:error,errorClassName:\"newThread-message\",errorMessage:error||'Oops! Something went wrong.',success:success,successClassName:\"newThread-message\",successMessage:React.createElement(Link,{to:\"/thread/\".concat(id)},'Successful on creating thread'),type:\"modal\"});if(!showEditor){return React.createElement(\"div\",null,statusMessage,\" \",React.createElement(\"div\",{className:\"newThread-hidden\"},React.createElement(Button,{size:\"small\",color:\"blue\",floated:\"left\",onClick:this.toggleShowEditor},React.createElement(Icon,{name:\"edit\"}),\"New Thread\")));}return React.createElement(\"div\",{className:\"newThread-show\"},statusMessage,React.createElement(Form,{loading:isLoading,className:\"attached fluid segment\"},React.createElement(Form.Input,{required:true,fluid:true,transparent:true,icon:\"edit\",iconPosition:\"left\",size:\"big\",placeholder:\"Name\",type:\"text\",name:\"name\",value:name,onChange:this.onNameChange}),React.createElement(Divider,null),React.createElement(RichEditor,{placeholder:\"Start typing your thread content here...\",editorState:editorState,wrapperClassName:\"newThread-wrapper\",toolbarClassName:\"newThread-toolbar\",editorClassName:\"newThread-editor\",onEditorStateChange:this.onEditorStateChange,handleBeforeInput:this.handleBeforeInput,handlePastedText:this.handlePastedText}),React.createElement(Button,{color:\"blue\",size:\"small\",loading:isLoading,disabled:isLoading,onClick:this.onSubmit},React.createElement(Icon,{name:\"edit\"}),\"Post thread\"),React.createElement(Button,{color:\"red\",role:\"none\",size:\"small\",disabled:isLoading,onClick:this.onSave},React.createElement(Icon,{name:\"save\"}),\"Save Draft\"),React.createElement(Button,{role:\"none\",size:\"small\",disabled:isLoading,onClick:this.onCancel},React.createElement(Icon,{name:\"cancel\"}),\"Clear\")));}}","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/components/newthread/index.js"],"names":["React","Component","Link","getSelectedBlock","htmlToDraft","List","EditorState","ContentState","convertFromRaw","convertToRaw","Modifier","Form","Icon","Divider","Button","RichEditor","StatusMessage","NewThread","constructor","props","convertToEditorState","content","editorState","createEmpty","contentState","JSON","parse","createWithContent","error","createFromText","toggleShowEditor","onSave","state","name","stringify","getCurrentContent","updateNewThread","onCancel","setState","onNameChange","e","value","onEditorStateChange","isFormValid","onSubmit","forum","createThread","newThread","isValidLength","maxLength","getPlainText","length","handleBeforeInput","input","handlePastedText","text","html","onChange","contentBlock","entityMap","forEach","key","mergeEntityData","replaceWithFragment","getSelection","contentBlocks","push","selectedBlock","newState","replaceText","getCurrentInlineStyle","type","componentWillReceiveProps","newProps","newName","newContent","render","isAuthenticated","isLoading","success","id","showEditor","statusMessage"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport {getSelectedBlock} from 'draftjs-utils';\r\nimport htmlToDraft from 'html-to-draftjs';\r\nimport {List} from 'immutable';\r\nimport {\r\n  EditorState,\r\n  ContentState,\r\n  convertFromRaw,\r\n  convertToRaw,\r\n  Modifier,\r\n} from 'draft-js';\r\nimport {Form, Icon, Divider, Button} from 'semantic-ui-react';\r\nimport './styles.css';\r\nimport RichEditor from '../richeditor';\r\nimport StatusMessage from '../statusmessage';\r\n\r\nexport default class NewThread extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const {name, content} = this.props;\r\n    let editorState = this.convertToEditorState(content);\r\n    this.state = {\r\n      name,\r\n      editorState,\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(newProps) {\r\n    const {name: newName, content: newContent} = newProps;\r\n    const editorState = this.convertToEditorState(newContent);\r\n    this.setState({\r\n      name: newName,\r\n      editorState,\r\n    });\r\n  }\r\n\r\n  convertToEditorState = content => {\r\n    let editorState = EditorState.createEmpty();\r\n    if (content) {\r\n      try {\r\n        const contentState = convertFromRaw(JSON.parse(content));\r\n        editorState = EditorState.createWithContent(contentState);\r\n      } catch (error) {\r\n        const contentState = ContentState.createFromText(content);\r\n        editorState = EditorState.createWithContent(contentState);\r\n      }\r\n    }\r\n    return editorState;\r\n  };\r\n\r\n  toggleShowEditor = () => {\r\n    this.props.toggleShowEditor();\r\n  };\r\n\r\n  onSave = () => {\r\n    // save to redux store (uncontrolled input way)\r\n    const {name, editorState} = this.state;\r\n    const content = JSON.stringify(\r\n      convertToRaw(editorState.getCurrentContent()),\r\n    );\r\n    this.props.updateNewThread({\r\n      name: name,\r\n      content: content,\r\n    });\r\n    this.toggleShowEditor();\r\n  };\r\n\r\n  onCancel = () => {\r\n    // reset & clear everything\r\n    const editorState = EditorState.createEmpty();\r\n    this.setState({\r\n      name: '',\r\n      editorState,\r\n    });\r\n    const content = JSON.stringify(\r\n      convertToRaw(editorState.getCurrentContent()),\r\n    );\r\n    this.props.updateNewThread({\r\n      name: '',\r\n      content: content,\r\n    });\r\n    this.toggleShowEditor();\r\n  };\r\n\r\n  onNameChange = (e, {value}) => {\r\n    this.setState({\r\n      name: value,\r\n    });\r\n  };\r\n\r\n  onEditorStateChange = editorState => {\r\n    this.setState({\r\n      editorState,\r\n    });\r\n  };\r\n\r\n  isFormValid = () => {\r\n    const {name} = this.state;\r\n    return name;\r\n  };\r\n\r\n  onSubmit = () => {\r\n    if (this.isFormValid()) {\r\n      const {name, editorState} = this.state;\r\n      const {forum, createThread} = this.props;\r\n      const content = JSON.stringify(\r\n        convertToRaw(editorState.getCurrentContent()),\r\n      );\r\n      let newThread = {\r\n        name: name,\r\n        forum: forum,\r\n        content: content,\r\n      };\r\n      createThread(newThread);\r\n    }\r\n  };\r\n\r\n  isValidLength = contentState => {\r\n    const maxLength = this.props.maxLength || 100;\r\n    return contentState.getPlainText('').length <= maxLength;\r\n  };\r\n\r\n  handleBeforeInput = input => {\r\n    const {editorState} = this.state;\r\n    if (!this.isValidLength(editorState.getCurrentContent())) {\r\n      return 'handled';\r\n    }\r\n  };\r\n\r\n  handlePastedText = (text, html, editorState, onChange) => {\r\n    if (html) {\r\n      const contentBlock = htmlToDraft(html);\r\n      let contentState = editorState.getCurrentContent();\r\n      contentBlock.entityMap.forEach((value, key) => {\r\n        contentState = contentState.mergeEntityData(key, value);\r\n      });\r\n      contentState = Modifier.replaceWithFragment(\r\n        contentState,\r\n        editorState.getSelection(),\r\n        new List(contentBlock.contentBlocks),\r\n      );\r\n      if (!this.isValidLength(contentState)) {\r\n        return 'handled';\r\n      }\r\n      onChange(\r\n        EditorState.push(editorState, contentState, 'insert-characters'),\r\n      );\r\n      return true;\r\n    }\r\n    const selectedBlock = getSelectedBlock(editorState);\r\n    const newState = Modifier.replaceText(\r\n      editorState.getCurrentContent(),\r\n      editorState.getSelection(),\r\n      text,\r\n      editorState.getCurrentInlineStyle(),\r\n    );\r\n    if (!this.isValidLength(newState)) {\r\n      return 'handled';\r\n    }\r\n    onChange(EditorState.push(editorState, newState, 'insert-characters'));\r\n    if (selectedBlock && selectedBlock.type === 'code') {\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      isAuthenticated,\r\n      isLoading,\r\n      success,\r\n      id,\r\n      error,\r\n      showEditor,\r\n    } = this.props;\r\n    const {name, editorState} = this.state;\r\n    if (!isAuthenticated) {\r\n      return <div className=\"newThread-none\" />;\r\n    }\r\n\r\n    const statusMessage = (\r\n      <StatusMessage\r\n        error={error}\r\n        errorClassName=\"newThread-message\"\r\n        errorMessage={error || 'Oops! Something went wrong.'}\r\n        success={success}\r\n        successClassName=\"newThread-message\"\r\n        successMessage={\r\n          <Link to={`/thread/${id}`}>{'Successful on creating thread'}</Link>\r\n        }\r\n        type=\"modal\"\r\n      />\r\n    );\r\n\r\n    if (!showEditor) {\r\n      return (\r\n        <div>\r\n          {statusMessage} {/*this will only show the success message*/}\r\n          <div className=\"newThread-hidden\">\r\n            <Button\r\n              size=\"small\"\r\n              color=\"blue\"\r\n              floated=\"left\"\r\n              onClick={this.toggleShowEditor}>\r\n              <Icon name=\"edit\" />\r\n              New Thread\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"newThread-show\">\r\n        {statusMessage}\r\n        <Form loading={isLoading} className=\"attached fluid segment\">\r\n          <Form.Input\r\n            required\r\n            fluid\r\n            transparent\r\n            icon=\"edit\"\r\n            iconPosition=\"left\"\r\n            size=\"big\"\r\n            placeholder=\"Name\"\r\n            type=\"text\"\r\n            name=\"name\"\r\n            value={name}\r\n            onChange={this.onNameChange}\r\n          />\r\n          <Divider />\r\n          <RichEditor\r\n            placeholder=\"Start typing your thread content here...\"\r\n            editorState={editorState}\r\n            wrapperClassName=\"newThread-wrapper\"\r\n            toolbarClassName=\"newThread-toolbar\"\r\n            editorClassName=\"newThread-editor\"\r\n            onEditorStateChange={this.onEditorStateChange}\r\n            handleBeforeInput={this.handleBeforeInput}\r\n            handlePastedText={this.handlePastedText}\r\n          />\r\n          <Button\r\n            color=\"blue\"\r\n            size=\"small\"\r\n            loading={isLoading}\r\n            disabled={isLoading}\r\n            onClick={this.onSubmit}>\r\n            <Icon name=\"edit\" />\r\n            Post thread\r\n          </Button>\r\n          <Button\r\n            color=\"red\"\r\n            role=\"none\"\r\n            size=\"small\"\r\n            disabled={isLoading}\r\n            onClick={this.onSave}>\r\n            <Icon name=\"save\" />\r\n            Save Draft\r\n          </Button>\r\n          <Button\r\n            role=\"none\"\r\n            size=\"small\"\r\n            disabled={isLoading}\r\n            onClick={this.onCancel}>\r\n            <Icon name=\"cancel\" />\r\n            Clear\r\n          </Button>\r\n        </Form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}