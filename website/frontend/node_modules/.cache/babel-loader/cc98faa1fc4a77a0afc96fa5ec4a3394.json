{"ast":null,"code":"import React,{Component}from'react';import{EditorState,ContentState,convertFromRaw}from'draft-js';import'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';import'./styles.css';import{Editor}from'react-draft-wysiwyg';import{imageUploadApi}from'../../api/image';export default class RichEditor extends Component{constructor(props){super(props);this.convertToEditorState=content=>{let editorState=EditorState.createEmpty();if(content){try{const contentState=convertFromRaw(JSON.parse(content));editorState=EditorState.createWithContent(contentState);}catch(error){const contentState=ContentState.createFromText(content);editorState=EditorState.createWithContent(contentState);}}return editorState;};this.onEditorStateChange=editorState=>{this.setState({editorState});};this.uploadImageCallBack=file=>{return new Promise((resolve,reject)=>{imageUploadApi(file,false).then(response=>{/* react-draft-wywsgi need data.link as the uploaded image url\r\n          so we had to slightly modify the result from cloudinary response */let newResponse={data:{link:response.data.secure_url}};resolve(newResponse);}).catch(error=>{reject(error);});});};let _this$props=this.props,_content=_this$props.content,_editorState=_this$props.editorState;_editorState=_editorState||this.convertToEditorState(_content);this.state={editorState:_editorState};}componentWillReceiveProps(newProps){const newEditorState=newProps.editorState,newContent=newProps.content;const editorState=newEditorState||this.convertToEditorState(newContent);this.setState({editorState});}render(){const _this$props2=this.props,readOnly=_this$props2.readOnly,wrapperClassName=_this$props2.wrapperClassName,toolbarClassName=_this$props2.toolbarClassName,editorClassName=_this$props2.editorClassName,handleBeforeInput=_this$props2.handleBeforeInput,handlePastedText=_this$props2.handlePastedText,onEditorStateChange=_this$props2.onEditorStateChange,editorState=_this$props2.editorState,uploadImageCallBack=_this$props2.uploadImageCallBack,placeholder=_this$props2.placeholder;return React.createElement(Editor,{toolbar:{options:['inline','blockType','fontSize','fontFamily','list','textAlign','colorPicker','link','emoji','image','history'],inline:{inDropdown:true},list:{inDropdown:true},textAlign:{inDropdown:true},link:{inDropdown:true},image:{uploadCallback:uploadImageCallBack||this.uploadImageCallBack,alt:{present:true},previewImage:true},fontFamily:{options:['Arial','Georgia','Impact','Tahoma','Roboto','Times New Roman','Verdana']}},editorState:editorState||this.state.editorState,wrapperClassName:wrapperClassName||'richEditor-wrapper',toolbarClassName:toolbarClassName||'richEditor-toolbar',editorClassName:editorClassName||'richEditor-editor',onEditorStateChange:onEditorStateChange||this.onEditorStateChange,readOnly:readOnly,toolbarHidden:readOnly,handleBeforeInput:handleBeforeInput,handlePastedText:handlePastedText,placeholder:placeholder});}}","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/components/richeditor/index.js"],"names":["React","Component","EditorState","ContentState","convertFromRaw","Editor","imageUploadApi","RichEditor","constructor","props","convertToEditorState","content","editorState","createEmpty","contentState","JSON","parse","createWithContent","error","createFromText","onEditorStateChange","setState","uploadImageCallBack","file","Promise","resolve","reject","then","response","newResponse","data","link","secure_url","catch","state","componentWillReceiveProps","newProps","newEditorState","newContent","render","readOnly","wrapperClassName","toolbarClassName","editorClassName","handleBeforeInput","handlePastedText","placeholder","options","inline","inDropdown","list","textAlign","image","uploadCallback","alt","present","previewImage","fontFamily"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,KAA+B,OAA/B,CACA,OAAQC,WAAR,CAAqBC,YAArB,CAAmCC,cAAnC,KAAwD,UAAxD,CACA,MAAO,kDAAP,CACA,MAAO,cAAP,CACA,OAAQC,MAAR,KAAqB,qBAArB,CACA,OAAQC,cAAR,KAA6B,iBAA7B,CAEA,cAAe,MAAMC,CAAAA,UAAN,QAAyBN,CAAAA,SAAU,CAChDO,WAAW,CAACC,KAAD,CAAQ,CACjB,MAAMA,KAAN,EADiB,KAiBnBC,oBAjBmB,CAiBIC,OAAO,EAAI,CAChC,GAAIC,CAAAA,WAAW,CAAGV,WAAW,CAACW,WAAZ,EAAlB,CACA,GAAIF,OAAJ,CAAa,CACX,GAAI,CACF,KAAMG,CAAAA,YAAY,CAAGV,cAAc,CAACW,IAAI,CAACC,KAAL,CAAWL,OAAX,CAAD,CAAnC,CACAC,WAAW,CAAGV,WAAW,CAACe,iBAAZ,CAA8BH,YAA9B,CAAd,CACD,CAAC,MAAOI,KAAP,CAAc,CACd,KAAMJ,CAAAA,YAAY,CAAGX,YAAY,CAACgB,cAAb,CAA4BR,OAA5B,CAArB,CACAC,WAAW,CAAGV,WAAW,CAACe,iBAAZ,CAA8BH,YAA9B,CAAd,CACD,CACF,CACD,MAAOF,CAAAA,WAAP,CACD,CA7BkB,MA+BnBQ,mBA/BmB,CA+BGR,WAAW,EAAI,CACnC,KAAKS,QAAL,CAAc,CACZT,WADY,CAAd,EAGD,CAnCkB,MAqCnBU,mBArCmB,CAqCGC,IAAI,EAAI,CAC5B,MAAO,IAAIC,CAAAA,OAAJ,CAAY,CAACC,OAAD,CAAUC,MAAV,GAAqB,CACtCpB,cAAc,CAACiB,IAAD,CAAO,KAAP,CAAd,CACGI,IADH,CACQC,QAAQ,EAAI,CAChB;6EAEA,GAAIC,CAAAA,WAAW,CAAG,CAChBC,IAAI,CAAE,CACJC,IAAI,CAAEH,QAAQ,CAACE,IAAT,CAAcE,UADhB,CADU,CAAlB,CAKAP,OAAO,CAACI,WAAD,CAAP,CACD,CAVH,EAWGI,KAXH,CAWSf,KAAK,EAAI,CACdQ,MAAM,CAACR,KAAD,CAAN,CACD,CAbH,EAcD,CAfM,CAAP,CAgBD,CAtDkB,iBAEY,KAAKT,KAFjB,CAEZE,QAFY,aAEZA,OAFY,CAEHC,YAFG,aAEHA,WAFG,CAGjBA,YAAW,CAAGA,YAAW,EAAI,KAAKF,oBAAL,CAA0BC,QAA1B,CAA7B,CACA,KAAKuB,KAAL,CAAa,CACXtB,WAAW,CAAXA,YADW,CAAb,CAGD,CAEDuB,yBAAyB,CAACC,QAAD,CAAW,MACdC,CAAAA,cADc,CACyBD,QADzB,CAC3BxB,WAD2B,CACW0B,UADX,CACyBF,QADzB,CACEzB,OADF,CAElC,KAAMC,CAAAA,WAAW,CAAGyB,cAAc,EAAI,KAAK3B,oBAAL,CAA0B4B,UAA1B,CAAtC,CACA,KAAKjB,QAAL,CAAc,CACZT,WADY,CAAd,EAGD,CAyCD2B,MAAM,EAAG,oBAYH,KAAK9B,KAZF,CAEL+B,QAFK,cAELA,QAFK,CAGLC,gBAHK,cAGLA,gBAHK,CAILC,gBAJK,cAILA,gBAJK,CAKLC,eALK,cAKLA,eALK,CAMLC,iBANK,cAMLA,iBANK,CAOLC,gBAPK,cAOLA,gBAPK,CAQLzB,mBARK,cAQLA,mBARK,CASLR,WATK,cASLA,WATK,CAULU,mBAVK,cAULA,mBAVK,CAWLwB,WAXK,cAWLA,WAXK,CAaP,MACE,qBAAC,MAAD,EACE,OAAO,CAAE,CACPC,OAAO,CAAE,CACP,QADO,CAEP,WAFO,CAGP,UAHO,CAIP,YAJO,CAKP,MALO,CAMP,WANO,CAOP,aAPO,CAQP,MARO,CASP,OATO,CAUP,OAVO,CAWP,SAXO,CADF,CAcPC,MAAM,CAAE,CAACC,UAAU,CAAE,IAAb,CAdD,CAePC,IAAI,CAAE,CAACD,UAAU,CAAE,IAAb,CAfC,CAgBPE,SAAS,CAAE,CAACF,UAAU,CAAE,IAAb,CAhBJ,CAiBPlB,IAAI,CAAE,CAACkB,UAAU,CAAE,IAAb,CAjBC,CAkBPG,KAAK,CAAE,CACLC,cAAc,CAAE/B,mBAAmB,EAAI,KAAKA,mBADvC,CAELgC,GAAG,CAAE,CAACC,OAAO,CAAE,IAAV,CAFA,CAGLC,YAAY,CAAE,IAHT,CAlBA,CAuBPC,UAAU,CAAE,CACVV,OAAO,CAAE,CACP,OADO,CAEP,SAFO,CAGP,QAHO,CAIP,QAJO,CAKP,QALO,CAMP,iBANO,CAOP,SAPO,CADC,CAvBL,CADX,CAoCE,WAAW,CAAEnC,WAAW,EAAI,KAAKsB,KAAL,CAAWtB,WApCzC,CAqCE,gBAAgB,CAAE6B,gBAAgB,EAAI,oBArCxC,CAsCE,gBAAgB,CAAEC,gBAAgB,EAAI,oBAtCxC,CAuCE,eAAe,CAAEC,eAAe,EAAI,mBAvCtC,CAwCE,mBAAmB,CAAEvB,mBAAmB,EAAI,KAAKA,mBAxCnD,CAyCE,QAAQ,CAAEoB,QAzCZ,CA0CE,aAAa,CAAEA,QA1CjB,CA2CE,iBAAiB,CAAEI,iBA3CrB,CA4CE,gBAAgB,CAAEC,gBA5CpB,CA6CE,WAAW,CAAEC,WA7Cf,EADF,CAiDD,CAvH+C","sourcesContent":["import React, {Component} from 'react';\r\nimport {EditorState, ContentState, convertFromRaw} from 'draft-js';\r\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\r\nimport './styles.css';\r\nimport {Editor} from 'react-draft-wysiwyg';\r\nimport {imageUploadApi} from '../../api/image';\r\n\r\nexport default class RichEditor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    let {content, editorState} = this.props;\r\n    editorState = editorState || this.convertToEditorState(content);\r\n    this.state = {\r\n      editorState,\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(newProps) {\r\n    const {editorState: newEditorState, content: newContent} = newProps;\r\n    const editorState = newEditorState || this.convertToEditorState(newContent);\r\n    this.setState({\r\n      editorState,\r\n    });\r\n  }\r\n\r\n  convertToEditorState = content => {\r\n    let editorState = EditorState.createEmpty();\r\n    if (content) {\r\n      try {\r\n        const contentState = convertFromRaw(JSON.parse(content));\r\n        editorState = EditorState.createWithContent(contentState);\r\n      } catch (error) {\r\n        const contentState = ContentState.createFromText(content);\r\n        editorState = EditorState.createWithContent(contentState);\r\n      }\r\n    }\r\n    return editorState;\r\n  };\r\n\r\n  onEditorStateChange = editorState => {\r\n    this.setState({\r\n      editorState,\r\n    });\r\n  };\r\n\r\n  uploadImageCallBack = file => {\r\n    return new Promise((resolve, reject) => {\r\n      imageUploadApi(file, false)\r\n        .then(response => {\r\n          /* react-draft-wywsgi need data.link as the uploaded image url\r\n          so we had to slightly modify the result from cloudinary response */\r\n          let newResponse = {\r\n            data: {\r\n              link: response.data.secure_url,\r\n            },\r\n          };\r\n          resolve(newResponse);\r\n        })\r\n        .catch(error => {\r\n          reject(error);\r\n        });\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      readOnly,\r\n      wrapperClassName,\r\n      toolbarClassName,\r\n      editorClassName,\r\n      handleBeforeInput,\r\n      handlePastedText,\r\n      onEditorStateChange,\r\n      editorState,\r\n      uploadImageCallBack,\r\n      placeholder,\r\n    } = this.props;\r\n    return (\r\n      <Editor\r\n        toolbar={{\r\n          options: [\r\n            'inline',\r\n            'blockType',\r\n            'fontSize',\r\n            'fontFamily',\r\n            'list',\r\n            'textAlign',\r\n            'colorPicker',\r\n            'link',\r\n            'emoji',\r\n            'image',\r\n            'history',\r\n          ],\r\n          inline: {inDropdown: true},\r\n          list: {inDropdown: true},\r\n          textAlign: {inDropdown: true},\r\n          link: {inDropdown: true},\r\n          image: {\r\n            uploadCallback: uploadImageCallBack || this.uploadImageCallBack,\r\n            alt: {present: true},\r\n            previewImage: true,\r\n          },\r\n          fontFamily: {\r\n            options: [\r\n              'Arial',\r\n              'Georgia',\r\n              'Impact',\r\n              'Tahoma',\r\n              'Roboto',\r\n              'Times New Roman',\r\n              'Verdana',\r\n            ],\r\n          },\r\n        }}\r\n        editorState={editorState || this.state.editorState}\r\n        wrapperClassName={wrapperClassName || 'richEditor-wrapper'}\r\n        toolbarClassName={toolbarClassName || 'richEditor-toolbar'}\r\n        editorClassName={editorClassName || 'richEditor-editor'}\r\n        onEditorStateChange={onEditorStateChange || this.onEditorStateChange}\r\n        readOnly={readOnly}\r\n        toolbarHidden={readOnly}\r\n        handleBeforeInput={handleBeforeInput}\r\n        handlePastedText={handlePastedText}\r\n        placeholder={placeholder}\r\n      />\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}