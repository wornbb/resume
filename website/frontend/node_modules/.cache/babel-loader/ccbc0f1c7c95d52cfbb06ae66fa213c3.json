{"ast":null,"code":"import { LOGIN_REQUEST, LOGIN_SUCCESS, LOGIN_FAILURE, LOGIN_RESET, EDIT_PROFILE_REQUEST, EDIT_PROFILE_SUCCESS, EDIT_PROFILE_FAILURE, EDIT_PROFILE_RESET, LOGOUT } from './types';\nimport { loginApi, logoutApi, editProfileApi } from '../api';\nimport store from '../store';\nimport { hideModal } from './modal';\nimport { apiErrorHandler } from '../utils/errorhandler';\nexport var login = function login(username, password) {\n  return function (dispatch) {\n    dispatch(loginRequest());\n    loginApi(username, password).then(function (response) {\n      dispatch(loginSuccess(response.data));\n      dispatch(hideModal());\n    }).catch(function (error) {\n      var errorMessage = apiErrorHandler(error);\n      dispatch(loginFailure(errorMessage));\n    });\n  };\n};\nexport var loginRequest = function loginRequest() {\n  return {\n    type: LOGIN_REQUEST\n  };\n};\nexport var loginSuccess = function loginSuccess(data) {\n  return {\n    type: LOGIN_SUCCESS,\n    token: data.token,\n    username: data.username,\n    name: data.name,\n    avatar: data.avatar,\n    isStaff: data.is_staff\n  };\n};\nexport var loginFailure = function loginFailure(error) {\n  return {\n    type: LOGIN_FAILURE,\n    error: error\n  };\n};\nexport var logout = function logout() {\n  return function (dispatch) {\n    logoutApi();\n    dispatch({\n      type: LOGOUT\n    });\n  };\n};\nexport var loginReset = function loginReset() {\n  return {\n    type: LOGIN_RESET\n  };\n};\nexport var editProfile = function editProfile(newProfile) {\n  return function (dispatch) {\n    dispatch(editProfileRequest());\n    var username = store.getState().auth.username;\n\n    if (!username) {\n      dispatch(editProfileFailure('Not authenticated'));\n    } else {\n      editProfileApi(username, newProfile).then(function (response) {\n        dispatch(editProfileSuccess(newProfile));\n      }).catch(function (error) {\n        var errorMessage = apiErrorHandler(error);\n        dispatch(editProfileFailure(errorMessage));\n      });\n    }\n  };\n};\nexport var editProfileRequest = function editProfileRequest() {\n  return {\n    type: EDIT_PROFILE_REQUEST\n  };\n};\nexport var editProfileSuccess = function editProfileSuccess(newProfile) {\n  return {\n    type: EDIT_PROFILE_SUCCESS,\n    avatar: newProfile.avatar,\n    name: newProfile.name\n  };\n};\nexport var editProfileFailure = function editProfileFailure(error) {\n  return {\n    type: EDIT_PROFILE_FAILURE,\n    error: error\n  };\n};\nexport var editProfileReset = function editProfileReset() {\n  return {\n    type: EDIT_PROFILE_RESET\n  };\n};","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/actions/auth.js"],"names":["LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILURE","LOGIN_RESET","EDIT_PROFILE_REQUEST","EDIT_PROFILE_SUCCESS","EDIT_PROFILE_FAILURE","EDIT_PROFILE_RESET","LOGOUT","loginApi","logoutApi","editProfileApi","store","hideModal","apiErrorHandler","login","username","password","dispatch","loginRequest","then","response","loginSuccess","data","catch","error","errorMessage","loginFailure","type","token","name","avatar","isStaff","is_staff","logout","loginReset","editProfile","newProfile","editProfileRequest","getState","auth","editProfileFailure","editProfileSuccess","editProfileReset"],"mappings":"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","sourcesContent":["import {\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAILURE,\r\n  LOGIN_RESET,\r\n  EDIT_PROFILE_REQUEST,\r\n  EDIT_PROFILE_SUCCESS,\r\n  EDIT_PROFILE_FAILURE,\r\n  EDIT_PROFILE_RESET,\r\n  LOGOUT,\r\n} from './types';\r\nimport {loginApi, logoutApi, editProfileApi} from '../api';\r\nimport store from '../store';\r\nimport {hideModal} from './modal';\r\nimport {apiErrorHandler} from '../utils/errorhandler';\r\n\r\nexport const login = (username, password) => dispatch => {\r\n  dispatch(loginRequest());\r\n\r\n  loginApi(username, password)\r\n    .then(response => {\r\n      dispatch(loginSuccess(response.data));\r\n      dispatch(hideModal());\r\n    })\r\n    .catch(error => {\r\n      const errorMessage = apiErrorHandler(error);\r\n      dispatch(loginFailure(errorMessage));\r\n    });\r\n};\r\n\r\nexport const loginRequest = () => {\r\n  return {\r\n    type: LOGIN_REQUEST,\r\n  };\r\n};\r\n\r\nexport const loginSuccess = data => {\r\n  return {\r\n    type: LOGIN_SUCCESS,\r\n    token: data.token,\r\n    username: data.username,\r\n    name: data.name,\r\n    avatar: data.avatar,\r\n    isStaff: data.is_staff,\r\n  };\r\n};\r\n\r\nexport const loginFailure = error => {\r\n  return {\r\n    type: LOGIN_FAILURE,\r\n    error,\r\n  };\r\n};\r\n\r\nexport const logout = () => dispatch => {\r\n  logoutApi();\r\n  dispatch({\r\n    type: LOGOUT,\r\n  });\r\n};\r\n\r\nexport const loginReset = () => {\r\n  return {\r\n    type: LOGIN_RESET,\r\n  };\r\n};\r\n\r\nexport const editProfile = newProfile => dispatch => {\r\n  dispatch(editProfileRequest());\r\n\r\n  const username = store.getState().auth.username;\r\n  if (!username) {\r\n    dispatch(editProfileFailure('Not authenticated'));\r\n  } else {\r\n    editProfileApi(username, newProfile)\r\n      .then(response => {\r\n        dispatch(editProfileSuccess(newProfile));\r\n      })\r\n      .catch(error => {\r\n        const errorMessage = apiErrorHandler(error);\r\n        dispatch(editProfileFailure(errorMessage));\r\n      });\r\n  }\r\n};\r\n\r\nexport const editProfileRequest = () => {\r\n  return {\r\n    type: EDIT_PROFILE_REQUEST,\r\n  };\r\n};\r\n\r\nexport const editProfileSuccess = newProfile => {\r\n  return {\r\n    type: EDIT_PROFILE_SUCCESS,\r\n    avatar: newProfile.avatar,\r\n    name: newProfile.name,\r\n  };\r\n};\r\n\r\nexport const editProfileFailure = error => {\r\n  return {\r\n    type: EDIT_PROFILE_FAILURE,\r\n    error,\r\n  };\r\n};\r\n\r\nexport const editProfileReset = () => {\r\n  return {\r\n    type: EDIT_PROFILE_RESET,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}