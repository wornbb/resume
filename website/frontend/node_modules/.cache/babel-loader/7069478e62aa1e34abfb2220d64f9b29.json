{"ast":null,"code":"import React,{Component}from'react';import Dropzone from'react-dropzone';import{Form,Image,Message,Button,TextArea,Grid}from'semantic-ui-react';import{imageUploadApi}from'../../api/image';import StatusMessage from'../../components/statusmessage';import'./styles.css';export default class EditProfile extends Component{constructor(props){super(props);this.handleChange=(e,{name,value})=>{this.setState({[name]:value});};this.onImageDrop=files=>{this.setState({avatarFile:files[0]});};this.editProfile=()=>{let newProfile={name:this.state.name,current_password:this.state.currentPassword,new_password:this.state.newPassword,bio:this.state.bio,avatar:this.state.avatar,status:this.state.status};this.props.handleEdit(newProfile);// prevent spamming so user have to keep entering password for every edit submission\nthis.setState({currentPassword:''});};this.handleSubmit=()=>{const _this$state=this.state,currentPassword=_this$state.currentPassword,avatarFile=_this$state.avatarFile;if(currentPassword!==''){if(!avatarFile){// no new avatar\nthis.editProfile();}else{this.setState({avatarUploading:true});imageUploadApi(avatarFile).then(response=>{this.setState({avatar:response.data.secure_url,avatarUploading:false});this.editProfile();}).catch(error=>{console.log(error);this.setState({avatarError:'Image Upload Error',avatarFile:null,avatarUploading:false});});}}};const _this$props=this.props,_name=_this$props.name,avatar=_this$props.avatar;this.state={name:_name,newPassword:'',currentPassword:'',bio:'',status:'',avatar:avatar,avatarFile:null,avatarError:null,avatarUploading:false};}render(){let _this$props2=this.props,isLoading=_this$props2.isLoading,error=_this$props2.error,success=_this$props2.success;let _this$state2=this.state,name=_this$state2.name,newPassword=_this$state2.newPassword,currentPassword=_this$state2.currentPassword,bio=_this$state2.bio,status=_this$state2.status,avatar=_this$state2.avatar,avatarFile=_this$state2.avatarFile,avatarError=_this$state2.avatarError,avatarUploading=_this$state2.avatarUploading;const statusMessage=React.createElement(StatusMessage,{error:error||avatarError,errorMessage:error||avatarError,loading:isLoading||avatarUploading,loadingMessage:'Editing your profile',success:success,successMessage:'Your profile edit was successful',type:\"modal\"});const avatarURL=avatarFile?avatarFile.preview:avatar;return React.createElement(\"div\",null,React.createElement(Message,{attached:true,header:\"Edit Your Profile\",content:\"Fill out any part of the form below to edit your profile\"}),statusMessage,React.createElement(Form,{className:\"attached segment\"},React.createElement(Grid,{celled:true,columns:2},React.createElement(Grid.Column,null,React.createElement(Form.Field,null,React.createElement(\"label\",null,\"Profile picture\"),React.createElement(Dropzone,{onDrop:this.onImageDrop,multiple:false,accept:\"image/*\"},React.createElement(Image,{src:avatarURL,className:\"editProfile-avatar\"}))),React.createElement(Form.Input,{label:\"Bio\",placeholder:\"Describe yourself\",type:\"text\",name:\"bio\",control:TextArea,value:bio,onChange:this.handleChange})),React.createElement(Grid.Column,null,React.createElement(Form.Input,{label:\"Name\",placeholder:\"Name\",type:\"text\",name:\"name\",value:name,onChange:this.handleChange}),React.createElement(Form.Input,{required:true,label:\"Current Password\",type:\"password\",name:\"currentPassword\",value:currentPassword,onChange:this.handleChange}),React.createElement(Form.Input,{label:\"New Password\",type:\"password\",name:\"newPassword\",value:newPassword,onChange:this.handleChange}),React.createElement(Form.Input,{label:\"Status\",placeholder:\"Who are you (e.g: Writer)\",type:\"text\",name:\"status\",value:status,onChange:this.handleChange}))),React.createElement(Button,{color:\"blue\",loading:isLoading,disabled:isLoading,onClick:this.handleSubmit},\"Submit\")));}}","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/components/editprofile/index.js"],"names":["React","Component","Dropzone","Form","Image","Message","Button","TextArea","Grid","imageUploadApi","StatusMessage","EditProfile","constructor","props","handleChange","e","name","value","setState","onImageDrop","files","avatarFile","editProfile","newProfile","state","current_password","currentPassword","new_password","newPassword","bio","avatar","status","handleEdit","handleSubmit","avatarUploading","then","response","data","secure_url","catch","error","console","log","avatarError","render","isLoading","success","statusMessage","avatarURL","preview"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport Dropzone from 'react-dropzone';\r\nimport {Form, Image, Message, Button, TextArea, Grid} from 'semantic-ui-react';\r\nimport {imageUploadApi} from '../../api/image';\r\nimport StatusMessage from '../../components/statusmessage';\r\nimport './styles.css';\r\n\r\nexport default class EditProfile extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const {name, avatar} = this.props;\r\n\r\n    this.state = {\r\n      name: name,\r\n      newPassword: '',\r\n      currentPassword: '',\r\n      bio: '',\r\n      status: '',\r\n      avatar: avatar,\r\n      avatarFile: null,\r\n      avatarError: null,\r\n      avatarUploading: false,\r\n    };\r\n  }\r\n\r\n  handleChange = (e, {name, value}) => {\r\n    this.setState({[name]: value});\r\n  };\r\n\r\n  onImageDrop = files => {\r\n    this.setState({\r\n      avatarFile: files[0],\r\n    });\r\n  };\r\n\r\n  editProfile = () => {\r\n    let newProfile = {\r\n      name: this.state.name,\r\n      current_password: this.state.currentPassword,\r\n      new_password: this.state.newPassword,\r\n      bio: this.state.bio,\r\n      avatar: this.state.avatar,\r\n      status: this.state.status,\r\n    };\r\n    this.props.handleEdit(newProfile);\r\n\r\n    // prevent spamming so user have to keep entering password for every edit submission\r\n    this.setState({\r\n      currentPassword: '',\r\n    });\r\n  };\r\n\r\n  handleSubmit = () => {\r\n    const {currentPassword, avatarFile} = this.state;\r\n\r\n    if (currentPassword !== '') {\r\n      if (!avatarFile) {\r\n        // no new avatar\r\n        this.editProfile();\r\n      } else {\r\n        this.setState({\r\n          avatarUploading: true,\r\n        });\r\n\r\n        imageUploadApi(avatarFile)\r\n          .then(response => {\r\n            this.setState({\r\n              avatar: response.data.secure_url,\r\n              avatarUploading: false,\r\n            });\r\n            this.editProfile();\r\n          })\r\n          .catch(error => {\r\n            console.log(error);\r\n            this.setState({\r\n              avatarError: 'Image Upload Error',\r\n              avatarFile: null,\r\n              avatarUploading: false,\r\n            });\r\n          });\r\n      }\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let {isLoading, error, success} = this.props;\r\n\r\n    let {\r\n      name,\r\n      newPassword,\r\n      currentPassword,\r\n      bio,\r\n      status,\r\n      avatar,\r\n      avatarFile,\r\n      avatarError,\r\n      avatarUploading,\r\n    } = this.state;\r\n\r\n    const statusMessage = (\r\n      <StatusMessage\r\n        error={error || avatarError}\r\n        errorMessage={error || avatarError}\r\n        loading={isLoading || avatarUploading}\r\n        loadingMessage={'Editing your profile'}\r\n        success={success}\r\n        successMessage={'Your profile edit was successful'}\r\n        type=\"modal\"\r\n      />\r\n    );\r\n    const avatarURL = avatarFile ? avatarFile.preview : avatar;\r\n\r\n    return (\r\n      <div>\r\n        <Message\r\n          attached\r\n          header=\"Edit Your Profile\"\r\n          content=\"Fill out any part of the form below to edit your profile\"\r\n        />\r\n        {statusMessage}\r\n        <Form className=\"attached segment\">\r\n          <Grid celled columns={2}>\r\n            <Grid.Column>\r\n              <Form.Field>\r\n                <label>Profile picture</label>\r\n                <Dropzone\r\n                  onDrop={this.onImageDrop}\r\n                  multiple={false}\r\n                  accept=\"image/*\">\r\n                  <Image src={avatarURL} className=\"editProfile-avatar\" />\r\n                </Dropzone>\r\n              </Form.Field>\r\n              <Form.Input\r\n                label=\"Bio\"\r\n                placeholder=\"Describe yourself\"\r\n                type=\"text\"\r\n                name=\"bio\"\r\n                control={TextArea}\r\n                value={bio}\r\n                onChange={this.handleChange}\r\n              />\r\n            </Grid.Column>\r\n            <Grid.Column>\r\n              <Form.Input\r\n                label=\"Name\"\r\n                placeholder=\"Name\"\r\n                type=\"text\"\r\n                name=\"name\"\r\n                value={name}\r\n                onChange={this.handleChange}\r\n              />\r\n              <Form.Input\r\n                required\r\n                label=\"Current Password\"\r\n                type=\"password\"\r\n                name=\"currentPassword\"\r\n                value={currentPassword}\r\n                onChange={this.handleChange}\r\n              />\r\n              <Form.Input\r\n                label=\"New Password\"\r\n                type=\"password\"\r\n                name=\"newPassword\"\r\n                value={newPassword}\r\n                onChange={this.handleChange}\r\n              />\r\n              <Form.Input\r\n                label=\"Status\"\r\n                placeholder=\"Who are you (e.g: Writer)\"\r\n                type=\"text\"\r\n                name=\"status\"\r\n                value={status}\r\n                onChange={this.handleChange}\r\n              />\r\n            </Grid.Column>\r\n          </Grid>\r\n          <Button\r\n            color=\"blue\"\r\n            loading={isLoading}\r\n            disabled={isLoading}\r\n            onClick={this.handleSubmit}>\r\n            Submit\r\n          </Button>\r\n        </Form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}