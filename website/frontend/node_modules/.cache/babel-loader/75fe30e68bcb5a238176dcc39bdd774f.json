{"ast":null,"code":"import{LOGIN_REQUEST,LOGIN_SUCCESS,LOGIN_FAILURE,LOGIN_RESET,EDIT_PROFILE_REQUEST,EDIT_PROFILE_SUCCESS,EDIT_PROFILE_FAILURE,EDIT_PROFILE_RESET,LOGOUT}from'./types';import{loginApi,logoutApi,editProfileApi}from'../api';import store from'../store';import{hideModal}from'./modal';import{apiErrorHandler}from'../utils/errorhandler';export const login=(username,password)=>dispatch=>{dispatch(loginRequest());loginApi(username,password).then(response=>{dispatch(loginSuccess(response.data));dispatch(hideModal());}).catch(error=>{const errorMessage=apiErrorHandler(error);dispatch(loginFailure(errorMessage));});};export const loginRequest=()=>{return{type:LOGIN_REQUEST};};export const loginSuccess=data=>{return{type:LOGIN_SUCCESS,token:data.token,username:data.username,name:data.name,avatar:data.avatar,isStaff:data.is_staff};};export const loginFailure=error=>{return{type:LOGIN_FAILURE,error};};export const logout=()=>dispatch=>{logoutApi();dispatch({type:LOGOUT});};export const loginReset=()=>{return{type:LOGIN_RESET};};export const editProfile=newProfile=>dispatch=>{dispatch(editProfileRequest());const username=store.getState().auth.username;if(!username){dispatch(editProfileFailure('Not authenticated'));}else{editProfileApi(username,newProfile).then(response=>{dispatch(editProfileSuccess(newProfile));}).catch(error=>{const errorMessage=apiErrorHandler(error);dispatch(editProfileFailure(errorMessage));});}};export const editProfileRequest=()=>{return{type:EDIT_PROFILE_REQUEST};};export const editProfileSuccess=newProfile=>{return{type:EDIT_PROFILE_SUCCESS,avatar:newProfile.avatar,name:newProfile.name};};export const editProfileFailure=error=>{return{type:EDIT_PROFILE_FAILURE,error};};export const editProfileReset=()=>{return{type:EDIT_PROFILE_RESET};};","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/actions/auth.js"],"names":["LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILURE","LOGIN_RESET","EDIT_PROFILE_REQUEST","EDIT_PROFILE_SUCCESS","EDIT_PROFILE_FAILURE","EDIT_PROFILE_RESET","LOGOUT","loginApi","logoutApi","editProfileApi","store","hideModal","apiErrorHandler","login","username","password","dispatch","loginRequest","then","response","loginSuccess","data","catch","error","errorMessage","loginFailure","type","token","name","avatar","isStaff","is_staff","logout","loginReset","editProfile","newProfile","editProfileRequest","getState","auth","editProfileFailure","editProfileSuccess","editProfileReset"],"mappings":"AAAA,OACEA,aADF,CAEEC,aAFF,CAGEC,aAHF,CAIEC,WAJF,CAKEC,oBALF,CAMEC,oBANF,CAOEC,oBAPF,CAQEC,kBARF,CASEC,MATF,KAUO,SAVP,CAWA,OAAQC,QAAR,CAAkBC,SAAlB,CAA6BC,cAA7B,KAAkD,QAAlD,CACA,MAAOC,CAAAA,KAAP,KAAkB,UAAlB,CACA,OAAQC,SAAR,KAAwB,SAAxB,CACA,OAAQC,eAAR,KAA8B,uBAA9B,CAEA,MAAO,MAAMC,CAAAA,KAAK,CAAG,CAACC,QAAD,CAAWC,QAAX,GAAwBC,QAAQ,EAAI,CACvDA,QAAQ,CAACC,YAAY,EAAb,CAAR,CAEAV,QAAQ,CAACO,QAAD,CAAWC,QAAX,CAAR,CACGG,IADH,CACQC,QAAQ,EAAI,CAChBH,QAAQ,CAACI,YAAY,CAACD,QAAQ,CAACE,IAAV,CAAb,CAAR,CACAL,QAAQ,CAACL,SAAS,EAAV,CAAR,CACD,CAJH,EAKGW,KALH,CAKSC,KAAK,EAAI,CACd,KAAMC,CAAAA,YAAY,CAAGZ,eAAe,CAACW,KAAD,CAApC,CACAP,QAAQ,CAACS,YAAY,CAACD,YAAD,CAAb,CAAR,CACD,CARH,EASD,CAZM,CAcP,MAAO,MAAMP,CAAAA,YAAY,CAAG,IAAM,CAChC,MAAO,CACLS,IAAI,CAAE5B,aADD,CAAP,CAGD,CAJM,CAMP,MAAO,MAAMsB,CAAAA,YAAY,CAAGC,IAAI,EAAI,CAClC,MAAO,CACLK,IAAI,CAAE3B,aADD,CAEL4B,KAAK,CAAEN,IAAI,CAACM,KAFP,CAGLb,QAAQ,CAAEO,IAAI,CAACP,QAHV,CAILc,IAAI,CAAEP,IAAI,CAACO,IAJN,CAKLC,MAAM,CAAER,IAAI,CAACQ,MALR,CAMLC,OAAO,CAAET,IAAI,CAACU,QANT,CAAP,CAQD,CATM,CAWP,MAAO,MAAMN,CAAAA,YAAY,CAAGF,KAAK,EAAI,CACnC,MAAO,CACLG,IAAI,CAAE1B,aADD,CAELuB,KAFK,CAAP,CAID,CALM,CAOP,MAAO,MAAMS,CAAAA,MAAM,CAAG,IAAMhB,QAAQ,EAAI,CACtCR,SAAS,GACTQ,QAAQ,CAAC,CACPU,IAAI,CAAEpB,MADC,CAAD,CAAR,CAGD,CALM,CAOP,MAAO,MAAM2B,CAAAA,UAAU,CAAG,IAAM,CAC9B,MAAO,CACLP,IAAI,CAAEzB,WADD,CAAP,CAGD,CAJM,CAMP,MAAO,MAAMiC,CAAAA,WAAW,CAAGC,UAAU,EAAInB,QAAQ,EAAI,CACnDA,QAAQ,CAACoB,kBAAkB,EAAnB,CAAR,CAEA,KAAMtB,CAAAA,QAAQ,CAAGJ,KAAK,CAAC2B,QAAN,GAAiBC,IAAjB,CAAsBxB,QAAvC,CACA,GAAI,CAACA,QAAL,CAAe,CACbE,QAAQ,CAACuB,kBAAkB,CAAC,mBAAD,CAAnB,CAAR,CACD,CAFD,IAEO,CACL9B,cAAc,CAACK,QAAD,CAAWqB,UAAX,CAAd,CACGjB,IADH,CACQC,QAAQ,EAAI,CAChBH,QAAQ,CAACwB,kBAAkB,CAACL,UAAD,CAAnB,CAAR,CACD,CAHH,EAIGb,KAJH,CAISC,KAAK,EAAI,CACd,KAAMC,CAAAA,YAAY,CAAGZ,eAAe,CAACW,KAAD,CAApC,CACAP,QAAQ,CAACuB,kBAAkB,CAACf,YAAD,CAAnB,CAAR,CACD,CAPH,EAQD,CACF,CAhBM,CAkBP,MAAO,MAAMY,CAAAA,kBAAkB,CAAG,IAAM,CACtC,MAAO,CACLV,IAAI,CAAExB,oBADD,CAAP,CAGD,CAJM,CAMP,MAAO,MAAMsC,CAAAA,kBAAkB,CAAGL,UAAU,EAAI,CAC9C,MAAO,CACLT,IAAI,CAAEvB,oBADD,CAEL0B,MAAM,CAAEM,UAAU,CAACN,MAFd,CAGLD,IAAI,CAAEO,UAAU,CAACP,IAHZ,CAAP,CAKD,CANM,CAQP,MAAO,MAAMW,CAAAA,kBAAkB,CAAGhB,KAAK,EAAI,CACzC,MAAO,CACLG,IAAI,CAAEtB,oBADD,CAELmB,KAFK,CAAP,CAID,CALM,CAOP,MAAO,MAAMkB,CAAAA,gBAAgB,CAAG,IAAM,CACpC,MAAO,CACLf,IAAI,CAAErB,kBADD,CAAP,CAGD,CAJM","sourcesContent":["import {\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAILURE,\r\n  LOGIN_RESET,\r\n  EDIT_PROFILE_REQUEST,\r\n  EDIT_PROFILE_SUCCESS,\r\n  EDIT_PROFILE_FAILURE,\r\n  EDIT_PROFILE_RESET,\r\n  LOGOUT,\r\n} from './types';\r\nimport {loginApi, logoutApi, editProfileApi} from '../api';\r\nimport store from '../store';\r\nimport {hideModal} from './modal';\r\nimport {apiErrorHandler} from '../utils/errorhandler';\r\n\r\nexport const login = (username, password) => dispatch => {\r\n  dispatch(loginRequest());\r\n\r\n  loginApi(username, password)\r\n    .then(response => {\r\n      dispatch(loginSuccess(response.data));\r\n      dispatch(hideModal());\r\n    })\r\n    .catch(error => {\r\n      const errorMessage = apiErrorHandler(error);\r\n      dispatch(loginFailure(errorMessage));\r\n    });\r\n};\r\n\r\nexport const loginRequest = () => {\r\n  return {\r\n    type: LOGIN_REQUEST,\r\n  };\r\n};\r\n\r\nexport const loginSuccess = data => {\r\n  return {\r\n    type: LOGIN_SUCCESS,\r\n    token: data.token,\r\n    username: data.username,\r\n    name: data.name,\r\n    avatar: data.avatar,\r\n    isStaff: data.is_staff,\r\n  };\r\n};\r\n\r\nexport const loginFailure = error => {\r\n  return {\r\n    type: LOGIN_FAILURE,\r\n    error,\r\n  };\r\n};\r\n\r\nexport const logout = () => dispatch => {\r\n  logoutApi();\r\n  dispatch({\r\n    type: LOGOUT,\r\n  });\r\n};\r\n\r\nexport const loginReset = () => {\r\n  return {\r\n    type: LOGIN_RESET,\r\n  };\r\n};\r\n\r\nexport const editProfile = newProfile => dispatch => {\r\n  dispatch(editProfileRequest());\r\n\r\n  const username = store.getState().auth.username;\r\n  if (!username) {\r\n    dispatch(editProfileFailure('Not authenticated'));\r\n  } else {\r\n    editProfileApi(username, newProfile)\r\n      .then(response => {\r\n        dispatch(editProfileSuccess(newProfile));\r\n      })\r\n      .catch(error => {\r\n        const errorMessage = apiErrorHandler(error);\r\n        dispatch(editProfileFailure(errorMessage));\r\n      });\r\n  }\r\n};\r\n\r\nexport const editProfileRequest = () => {\r\n  return {\r\n    type: EDIT_PROFILE_REQUEST,\r\n  };\r\n};\r\n\r\nexport const editProfileSuccess = newProfile => {\r\n  return {\r\n    type: EDIT_PROFILE_SUCCESS,\r\n    avatar: newProfile.avatar,\r\n    name: newProfile.name,\r\n  };\r\n};\r\n\r\nexport const editProfileFailure = error => {\r\n  return {\r\n    type: EDIT_PROFILE_FAILURE,\r\n    error,\r\n  };\r\n};\r\n\r\nexport const editProfileReset = () => {\r\n  return {\r\n    type: EDIT_PROFILE_RESET,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}