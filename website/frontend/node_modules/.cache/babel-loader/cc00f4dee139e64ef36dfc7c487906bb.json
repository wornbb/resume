{"ast":null,"code":"var _jsxFileName = \"/home/yi/Desktop/rengorum/frontend/src/components/richeditor/index.js\";\nimport React, { Component } from 'react';\nimport { EditorState, ContentState, convertFromRaw } from 'draft-js';\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\nimport './styles.css';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { imageUploadApi } from '../../api/image';\nexport default class RichEditor extends Component {\n  constructor(props) {\n    super(props);\n\n    this.convertToEditorState = content => {\n      let editorState = EditorState.createEmpty();\n\n      if (content) {\n        try {\n          const contentState = convertFromRaw(JSON.parse(content));\n          editorState = EditorState.createWithContent(contentState);\n        } catch (error) {\n          const contentState = ContentState.createFromText(content);\n          editorState = EditorState.createWithContent(contentState);\n        }\n      }\n\n      return editorState;\n    };\n\n    this.onEditorStateChange = editorState => {\n      this.setState({\n        editorState\n      });\n    };\n\n    this.uploadImageCallBack = file => {\n      return new Promise((resolve, reject) => {\n        imageUploadApi(file, false).then(response => {\n          /* react-draft-wywsgi need data.link as the uploaded image url\r\n          so we had to slightly modify the result from cloudinary response */\n          let newResponse = {\n            data: {\n              link: response.data.secure_url\n            }\n          };\n          resolve(newResponse);\n        }).catch(error => {\n          reject(error);\n        });\n      });\n    };\n\n    let _this$props = this.props,\n        _content = _this$props.content,\n        _editorState = _this$props.editorState;\n    _editorState = _editorState || this.convertToEditorState(_content);\n    this.state = {\n      editorState: _editorState\n    };\n  }\n\n  componentWillReceiveProps(newProps) {\n    const newEditorState = newProps.editorState,\n          newContent = newProps.content;\n    const editorState = newEditorState || this.convertToEditorState(newContent);\n    this.setState({\n      editorState\n    });\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          readOnly = _this$props2.readOnly,\n          wrapperClassName = _this$props2.wrapperClassName,\n          toolbarClassName = _this$props2.toolbarClassName,\n          editorClassName = _this$props2.editorClassName,\n          handleBeforeInput = _this$props2.handleBeforeInput,\n          handlePastedText = _this$props2.handlePastedText,\n          onEditorStateChange = _this$props2.onEditorStateChange,\n          editorState = _this$props2.editorState,\n          uploadImageCallBack = _this$props2.uploadImageCallBack,\n          placeholder = _this$props2.placeholder;\n    return React.createElement(Editor, {\n      toolbar: {\n        options: ['inline', 'blockType', 'fontSize', 'fontFamily', 'list', 'textAlign', 'colorPicker', 'link', 'emoji', 'image', 'history'],\n        inline: {\n          inDropdown: true\n        },\n        list: {\n          inDropdown: true\n        },\n        textAlign: {\n          inDropdown: true\n        },\n        link: {\n          inDropdown: true\n        },\n        image: {\n          uploadCallback: uploadImageCallBack || this.uploadImageCallBack,\n          alt: {\n            present: true\n          },\n          previewImage: true\n        },\n        fontFamily: {\n          options: ['Arial', 'Georgia', 'Impact', 'Tahoma', 'Roboto', 'Times New Roman', 'Verdana']\n        }\n      },\n      editorState: editorState || this.state.editorState,\n      wrapperClassName: wrapperClassName || 'richEditor-wrapper',\n      toolbarClassName: toolbarClassName || 'richEditor-toolbar',\n      editorClassName: editorClassName || 'richEditor-editor',\n      onEditorStateChange: onEditorStateChange || this.onEditorStateChange,\n      readOnly: readOnly,\n      toolbarHidden: readOnly,\n      handleBeforeInput: handleBeforeInput,\n      handlePastedText: handlePastedText,\n      placeholder: placeholder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    });\n  }\n\n}","map":{"version":3,"sources":["/home/yi/Desktop/rengorum/frontend/src/components/richeditor/index.js"],"names":["React","Component","EditorState","ContentState","convertFromRaw","Editor","imageUploadApi","RichEditor","constructor","props","convertToEditorState","content","editorState","createEmpty","contentState","JSON","parse","createWithContent","error","createFromText","onEditorStateChange","setState","uploadImageCallBack","file","Promise","resolve","reject","then","response","newResponse","data","link","secure_url","catch","state","componentWillReceiveProps","newProps","newEditorState","newContent","render","readOnly","wrapperClassName","toolbarClassName","editorClassName","handleBeforeInput","handlePastedText","placeholder","options","inline","inDropdown","list","textAlign","image","uploadCallback","alt","present","previewImage","fontFamily"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {EditorState, ContentState, convertFromRaw} from 'draft-js';\r\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\r\nimport './styles.css';\r\nimport {Editor} from 'react-draft-wysiwyg';\r\nimport {imageUploadApi} from '../../api/image';\r\n\r\nexport default class RichEditor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    let {content, editorState} = this.props;\r\n    editorState = editorState || this.convertToEditorState(content);\r\n    this.state = {\r\n      editorState,\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(newProps) {\r\n    const {editorState: newEditorState, content: newContent} = newProps;\r\n    const editorState = newEditorState || this.convertToEditorState(newContent);\r\n    this.setState({\r\n      editorState,\r\n    });\r\n  }\r\n\r\n  convertToEditorState = content => {\r\n    let editorState = EditorState.createEmpty();\r\n    if (content) {\r\n      try {\r\n        const contentState = convertFromRaw(JSON.parse(content));\r\n        editorState = EditorState.createWithContent(contentState);\r\n      } catch (error) {\r\n        const contentState = ContentState.createFromText(content);\r\n        editorState = EditorState.createWithContent(contentState);\r\n      }\r\n    }\r\n    return editorState;\r\n  };\r\n\r\n  onEditorStateChange = editorState => {\r\n    this.setState({\r\n      editorState,\r\n    });\r\n  };\r\n\r\n  uploadImageCallBack = file => {\r\n    return new Promise((resolve, reject) => {\r\n      imageUploadApi(file, false)\r\n        .then(response => {\r\n          /* react-draft-wywsgi need data.link as the uploaded image url\r\n          so we had to slightly modify the result from cloudinary response */\r\n          let newResponse = {\r\n            data: {\r\n              link: response.data.secure_url,\r\n            },\r\n          };\r\n          resolve(newResponse);\r\n        })\r\n        .catch(error => {\r\n          reject(error);\r\n        });\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      readOnly,\r\n      wrapperClassName,\r\n      toolbarClassName,\r\n      editorClassName,\r\n      handleBeforeInput,\r\n      handlePastedText,\r\n      onEditorStateChange,\r\n      editorState,\r\n      uploadImageCallBack,\r\n      placeholder,\r\n    } = this.props;\r\n    return (\r\n      <Editor\r\n        toolbar={{\r\n          options: [\r\n            'inline',\r\n            'blockType',\r\n            'fontSize',\r\n            'fontFamily',\r\n            'list',\r\n            'textAlign',\r\n            'colorPicker',\r\n            'link',\r\n            'emoji',\r\n            'image',\r\n            'history',\r\n          ],\r\n          inline: {inDropdown: true},\r\n          list: {inDropdown: true},\r\n          textAlign: {inDropdown: true},\r\n          link: {inDropdown: true},\r\n          image: {\r\n            uploadCallback: uploadImageCallBack || this.uploadImageCallBack,\r\n            alt: {present: true},\r\n            previewImage: true,\r\n          },\r\n          fontFamily: {\r\n            options: [\r\n              'Arial',\r\n              'Georgia',\r\n              'Impact',\r\n              'Tahoma',\r\n              'Roboto',\r\n              'Times New Roman',\r\n              'Verdana',\r\n            ],\r\n          },\r\n        }}\r\n        editorState={editorState || this.state.editorState}\r\n        wrapperClassName={wrapperClassName || 'richEditor-wrapper'}\r\n        toolbarClassName={toolbarClassName || 'richEditor-toolbar'}\r\n        editorClassName={editorClassName || 'richEditor-editor'}\r\n        onEditorStateChange={onEditorStateChange || this.onEditorStateChange}\r\n        readOnly={readOnly}\r\n        toolbarHidden={readOnly}\r\n        handleBeforeInput={handleBeforeInput}\r\n        handlePastedText={handlePastedText}\r\n        placeholder={placeholder}\r\n      />\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}